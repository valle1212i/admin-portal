<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin ‚Äì Marknadsf√∂ringsans√∂kningar</title>
  <link rel="stylesheet" href="css/admin-marknadsforing.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
</head>
<body>
  <div class="sidebar">
    <h2>Admin</h2>
    <ul class="nav">
      <li><a href="dashboard.html">Dashboard</a></li>
      <li class="active"><a href="admin-marknadsforing.html">Marknadsf√∂ring</a></li>
      <li><a href="customers.html">Kunder</a></li>
      <li><a href="settings.html">Inst√§llningar</a></li>
    </ul>
  </div>

  <main class="content">
    <h1>üìÖ Marknadsf√∂ringsval</h1>
    <div id="submissions" class="submission-list">
      <p>Laddar kunddata...</p>
    </div>
  </main>

  <script>
    async function fetchSubmissions() {
      const container = document.getElementById("submissions");
      container.innerHTML = "‚ôªÔ∏è H√§mtar data...";

      try {
        const res = await fetch("/api/customers/marketing-submissions");
        const kunder = await res.json();

        if (!kunder.length) {
          return container.innerHTML = "<p>Inga inskickade val √§nnu.</p>";
        }

        container.innerHTML = "";

        kunder.forEach(kund => {
          const box = document.createElement("div");
          box.className = "submission-box";

          box.innerHTML = `
            <h3>${kund.name || "Namn saknas"} <span>(${kund.email})</span></h3>
            <p><strong>Google Ads:</strong> ${kund.marketing?.googleAds?.goals || "-"}</p>
            <p><strong>Meta Ads:</strong> ${kund.marketing?.metaAds?.goals || "-"}</p>
            <p><strong>TikTok Ads:</strong> ${kund.marketing?.tiktokAds?.goals || "-"}</p>
            <p><strong>LinkedIn Ads:</strong> ${kund.marketing?.linkedinAds?.goals || "-"}</p>
            <p><strong>Senast uppdaterad:</strong> ${kund.marketing?.updatedAt ? new Date(kund.marketing.updatedAt).toLocaleDateString('sv-SE') : "Ok√§nt"}</p>
          `;

          container.appendChild(box);
        });
      } catch (err) {
        console.error("Fel vid h√§mtning:", err);
        container.innerHTML = "<p class='error'>‚õîÔ∏è Fel vid h√§mtning av data.</p>";
      }
    }

    fetchSubmissions();
  </script>
</body>
</html>
